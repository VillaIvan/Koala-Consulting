---
import Met from "@/components/Met.astro";
import imagen from "@/assets/imagen.png";
import TabNavigation from "@/components/TabNavigation.astro";
---

<section id="panels">
  <div id="panels-container" style="width: 300%;">
    <article id="panel-1" class="panel full-screen">
      <div class="container">
        <section class="mx-auto max-w-7xl mb-20 p-4" id="nosotros">
          <div class="p-2">
            <h1 class="text-7xl text-white font-semibold text-center mb-10">
              ¿Quiénes Somos?
            </h1>
          </div>
          <hr class="w-52 mx-auto border-t border-gray-300 mb-10" />
          <div class="p-2">
            <p class="text-2xl text-white font-normal mb-20 text-center">
              Somos una empresa líder en consultoría estratégica con una
              trayectoria de más de 10 años en optimización de procesos en las
              industrias aseguradoras y tecnológicas. Nos especializamos en
              identificar oportunidades de mejora y en implementar soluciones
              que tienen un impacto directo en la eficiencia, el costo
              operativo, las ventas y la satisfacción del cliente. Nuestro
              objetivo es impulsar el éxito de su negocio a través de
              estrategias innovadoras y personalizadas.
            </p>
          </div>
          <Met />
        </section>
      </div>
    </article>
    <article id="panel-2" class="panel full-screen gradient-blue">
      <div class="container">
        <section
          class="h-auto md:h-[100vh] mx-auto max-w-7xl p-4"
          id="servicios"
        >
          <div class="grid grid-cols-1 md:grid-cols-2 mb-10">
            <div>
              <img
                src={imagen.src}
                alt="imagen de gente trabajando"
                class="shadow-xl m-auto w-[75%]"
              />
            </div>
            <div class="w-full flex flex-col gap-5 justify-center items-center">
              <h3
                class="text-white text-4xl md:text-5xl text-center font-bold mt-10 md:mt-0"
              >
                Ayudamos a Nuestros Clientes a Resolver sus Problemas más
                Difíciles.
              </h3>
              <p
                class="text-white text-xl font-normal text-center md:text-start"
              >
                Conecta datos, procesos y equipos de trabajo con soluciones de
                negocio que generen agilidad operativa y más oportunidades de
                ventas.
              </p>
              <div class="flex flex-col md:flex-row justify-center gap-5">
                <div class="flex flex-row gap-3 ml-7 md:ml-0">
                  <div
                    class="rounded-full bg-white bg-opacity-30 w-[62px] md:w-[75px] h-[60px] md:h-[75px] flex items-center justify-center"
                  >
                    <svg
                      width="36"
                      height="25"
                      viewBox="0 0 36 25"
                      class=""
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M5.42821 10.54C7.36227 10.54 8.93472 8.96757 8.93472 7.03352C8.93472 5.09946 7.36227 3.52701 5.42821 3.52701C3.49416 3.52701 1.92171 5.09946 1.92171 7.03352C1.92171 8.96757 3.49416 10.54 5.42821 10.54ZM29.9737 10.54C31.9078 10.54 33.4803 8.96757 33.4803 7.03352C33.4803 5.09946 31.9078 3.52701 29.9737 3.52701C28.0397 3.52701 26.4672 5.09946 26.4672 7.03352C26.4672 8.96757 28.0397 10.54 29.9737 10.54ZM31.727 12.2933H28.2205C27.2562 12.2933 26.3851 12.6823 25.7495 13.3124C27.9575 14.5232 29.5245 16.7093 29.8642 19.3063H33.4803C34.45 19.3063 35.2335 18.5228 35.2335 17.553V15.7998C35.2335 13.8657 33.6611 12.2933 31.727 12.2933ZM17.701 12.2933C21.0924 12.2933 23.8374 9.54834 23.8374 6.15689C23.8374 2.76544 21.0924 0.0205078 17.701 0.0205078C14.3095 0.0205078 11.5646 2.76544 11.5646 6.15689C11.5646 9.54834 14.3095 12.2933 17.701 12.2933ZM21.9088 14.0465H21.454C20.3144 14.5944 19.0488 14.9232 17.701 14.9232C16.3532 14.9232 15.093 14.5944 13.9479 14.0465H13.4932C10.0086 14.0465 7.18147 16.8736 7.18147 20.3582V21.9362C7.18147 23.3881 8.35943 24.566 9.81134 24.566H25.5906C27.0425 24.566 28.2205 23.3881 28.2205 21.9362V20.3582C28.2205 16.8736 25.3934 14.0465 21.9088 14.0465ZM9.65246 13.3124C9.0169 12.6823 8.14575 12.2933 7.18147 12.2933H3.67496C1.74091 12.2933 0.168457 13.8657 0.168457 15.7998V17.553C0.168457 18.5228 0.951942 19.3063 1.92171 19.3063H5.53231C5.87748 16.7093 7.44445 14.5232 9.65246 13.3124Z"
                        fill="white"></path>
                    </svg>
                  </div>
                  <p class="text-white my-auto font-bold text-xl">
                    Equipo Altamente Calificado
                  </p>
                </div>
              </div>
              <div
                class="px-16 py-4 rounded-xl shadow-lg text-xl font-semibold cursor-pointer
                hover:bg-secondary hover:text-white
                bg-teal-100
                text-primary
                border duration-200 ease-in-out
                border-secondary transition"
              >
                <a id="contact-button3" href="#contact"> Conocer Mas ➡ </a>
              </div>
            </div>
          </div>
          <TabNavigation />
        </section>
      </div>
    </article>
    <article id="panel-3" class="panel full-screen gradient-green">
      <div class="container">
        <section class="mx-auto max-w-7xl mb-20 p-4" id="nosotros">
          <div class="p-2">
            <h1 class="text-7xl text-white font-semibold text-center mb-10">
              ¿Quiénes Somos?
            </h1>
          </div>
          <hr class="w-52 mx-auto border-t border-gray-300 mb-10" />
          <div class="p-2">
            <p class="text-2xl text-white font-normal mb-20 text-center">
              Somos una empresa líder en consultoría estratégica con una
              trayectoria de más de 10 años en optimización de procesos en las
              industrias aseguradoras y tecnológicas. Nos especializamos en
              identificar oportunidades de mejora y en implementar soluciones
              que tienen un impacto directo en la eficiencia, el costo
              operativo, las ventas y la satisfacción del cliente. Nuestro
              objetivo es impulsar el éxito de su negocio a través de
              estrategias innovadoras y personalizadas.
            </p>
          </div>
          <Met />
        </section>
      </div>
    </article>
  </div>
</section>

<style>
  h1,
  h2 {
    text-align: center;
  }

  .full-screen {
    display: block;
    width: 100%;
    height: 100vh;
    overflow: hidden;
  }

  #masthead {
    position: fixed;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    z-index: 9999;
  }
  #masthead a {
    padding: 1rem 2rem;
  }

  #panels #panels-container {
    height: 100vh;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: nowrap;
    flex-wrap: nowrap;
    padding: 0;
    overflow: hidden;
  }
  #panels #panels-container .panel {
    position: relative;
    width: 100%;
    height: 100vh;
    overflow: hidden;
    display: flex;
    text-align: left;
    align-items: center;
    justify-content: center;
    border-right: 1px solid #f00;
  }
  #panels #panels-container .panel img {
    max-width: 100%;
    height: auto;
    display: block;
  }
  #panels #panels-container .panel .panels-navigation {
    width: 100%;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: end;
    -ms-flex-pack: end;
    justify-content: flex-end;
  }
  #panels #panels-container .panel .anchor-panel,
  #panels #panels-container .panel .nav-panel {
    text-transform: uppercase;
    margin-right: 2rem;
  }
  #panels #panels-container .panels-navigation {
    position: absolute;
    width: 100%;
    bottom: 2rem;
    right: 2rem;
  }

  @media (max-width: 768px) {
    #panels-container {
      display: flex;
      flex-direction: column; /* Hace que los contenedores se apilen uno debajo del otro */
      width: 100% !important;
      height: auto !important; /* Permite que los contenedores tengan una altura automática */
      overflow-x: visible !important; /* Asegura que no haya desbordamiento horizontal */
    }

    .panel {
      width: 100% !important; /* Asegura que cada panel ocupe el 100% del ancho */
      height: auto !important; /* Ajusta la altura de cada panel según el contenido */
      margin-bottom: 20px; /* Agrega espacio entre los paneles */
    }

    /* Ajusta el texto o el contenido que pueda estar causando problemas */
    .panel-content {
      font-size: 16px !important; /* Ajusta el tamaño de texto si es necesario */
    }
  }
</style>

<script>
  import { gsap } from "gsap";
  import ScrollTrigger from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  // Inicializa la animación GSAP
  function initGsap() {
    console.log("Iniciando GSAP..."); // Depuración para verificar si se llama
    const panelsContainer = document.querySelector(
      "#panels-container"
    ) as HTMLElement;
    const panels = gsap.utils.toArray("#panels-container .panel");

    // Verificar si los elementos necesarios existen
    if (!panelsContainer || panels.length === 0) {
      console.warn("No se encontraron elementos para inicializar GSAP.");
      return;
    }

    gsap.to(panels, {
      xPercent: -100 * (panels.length - 1),
      ease: "none",
      scrollTrigger: {
        trigger: "#panels-container",
        pin: true,
        start: "top top",
        scrub: 1,
        snap: {
          snapTo: 1 / (panels.length - 1),
          inertia: false,
          duration: { min: 0.1, max: 0.1 },
        },
        end: () => "+=" + (panelsContainer.offsetWidth - window.innerWidth),
      },
    });
  }

  function setupGsapForMobile() {
    const isMobile = window.matchMedia("(max-width: 768px)").matches;

    // Limpia animaciones existentes
    ScrollTrigger.getAll().forEach((trigger) => trigger.kill());

    if (isMobile) {
      // Desactivar animación de scroll horizontal en móvil
      console.log("Dispositivo móvil detectado. Desactivando GSAP...");
      gsap.to("#panels-container", { xPercent: 0 }); // Resetea el desplazamiento horizontal
      // Aquí puedes añadir cualquier lógica para cambiar la estructura en móviles si lo necesitas
    } else {
      initGsap();
      console.log("Modo desktop. ScrollTrigger activado.");
    }
  }

  // Ejecutar al cargar la página
  window.addEventListener("load", () => {
    console.log("Página cargada. Configurando GSAP...");
    setupGsapForMobile();
  });

  // Re-evaluar al cambiar el tamaño de la ventana
  window.addEventListener("resize", setupGsapForMobile);
</script>
